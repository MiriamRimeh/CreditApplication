@page
@model IndexModel
@{
    ViewData["Title"] = "Начало";
}


<div class="container mt-5">
    <div class="row" >
        <div class="col-md-4">
            <h2 class="mb-6">Калкулатор</h2>
            <div class="card shadow-sm p-4">
                <div class="mb-3">
                    <label asp-for="Amount" class="form-label">Сума (лв.)</label>
                    <input asp-for="Amount" type="number" class="form-control" id="amount" min="300" max="5000" step="100" />
                </div>
                <div class="mb-3">
                    <label asp-for="PeriodMonths" class="form-label">Период (месеци)</label>
                    <input asp-for="PeriodMonths" type="number" class="form-control" id="period" min="5" max="24" step="1" />
                </div>
                <div class="mt-4 p-3 bg-light rounded">
                    <p>Месечна вноска: <strong id="monthlyPayment">0.00 лв.</strong></p>
                    <p>Общо за плащане: <strong id="totalPayment">0.00 лв.</strong></p>
                    <p class="text-secondary"><small>ГЛП: 40% </small></p>

                </div>
                <div class="mt-4 text-end">
                    <a class="btn btn-primary-miriam btn-lg rounded-pill " href="/ApplicationForm/Step1_Personal">Вземи сега</a>
                </div>
            </div>
        </div>
        <div class="col-md-8 d-flex align-items-center justify-content-center h-100 overflow-auto p-0">
            <img src="~/images/homePage.jpg" class="img-fluid" style="object-fit: cover;" alt="Начална страница" />
        </div>
    </div>  
</div>

@section Scripts {
    <script>
        const amountInput = document.getElementById('amount');
        const periodInput = document.getElementById('period');
        const monthlyLabel = document.getElementById('monthlyPayment');
        const totalLabel = document.getElementById('totalPayment');
        const interestRate = 0.40; 

        function calculate() {
            const principal = parseFloat(amountInput.value) || 0;
            const months = parseInt(periodInput.value) || 0;
            if (principal < 300 || principal > 5000 || months < 5 || months > 24) {
                monthlyLabel.textContent = '0.00 лв.';
                totalLabel.textContent = '0.00 лв.';
                return;
            }
            const monthlyRate = interestRate / 12;
            const monthly = (principal * monthlyRate) / (1 - Math.pow(1 + monthlyRate, -months));
            const total = monthly * months;
            monthlyLabel.textContent = monthly.toFixed(2) + ' лв.';
            totalLabel.textContent = total.toFixed(2) + ' лв.';
        }

        amountInput.addEventListener('input', calculate);
        periodInput.addEventListener('input', calculate);
    </script>
}