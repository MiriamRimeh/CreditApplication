@page
@using Microsoft.AspNetCore.Authorization
@attribute [Authorize(Roles = "Client")]
@model CreditApplication.Pages.Accounts.ProfileModel
@{
    ViewData["Title"] = "Профил";
}


<div class="container mt-4">
    <h3>Моят профил</h3>

    <div class="card mb-4">
        <div class="card-header"><h5><strong>Лични данни</strong> <a asp-page="/Clients/Edit" class="btn btn-sm btn-secondary ms-2 float-end">Редактирай</a></h5></div>
        
        <div class="card-body">
            <p><strong>Име:</strong> @Model.Client.FirstName @Model.Client.LastName</p>
            <p><strong>ЕГН:</strong> @Model.Client.EGN</p>
            <p><strong>Телефон:</strong> @Model.Client.PhoneNumber</p>
            <p><strong>№ на лична карта:</strong> @Model.Client.IDCardNumber</p>
            <p><strong>Дата на издаване:</strong> @Model.Client.IDIssueDate.ToString("dd.MM.yyyy")</p>
            <p><strong>Дата на валидност:</strong> @Model.Client.IDValidityDate.ToString("dd.MM.yyyy")</p>
            <p><strong>Град на издаване:</strong> @Model.Client.IDIssuer</p>
        </div>
    </div>

    <div class="card mb-4">
        <div class="card-header"><h5><strong>Адрес</strong> <a asp-page="/ClientAddresses/Edit" class="btn btn-sm btn-secondary ms-2 float-end">Редактирай</a></h5></div>
        <div class="card-body">
            <p>@Model.Address.City, @Model.Address.StreetNeighbourhood @Model.Address.Number, @Model.Address.PostCode</p>
        </div>
    </div>

    <div class="card mb-4">
        <div class="card-header"><h5><strong>Финансова информация</strong> <a asp-page="/ClientFinancials/Edit" class="btn btn-sm btn-secondary ms-2 float-end">Редактирай</a></h5></div>
        <div class="card-body">
            <p><strong>Доход:</strong> @Model.Financials.MontlyIncome лв.</p>
            <p><strong>Разходи:</strong> @Model.Financials.MontlyExpenses лв.</p>
            <p><strong>Тип заетост:</strong> @Model.Financials.EmploymentType/* Nomenclature.Description */</p>
        </div>
    </div>

    <h3>Моите кредити</h3>

    <ul class="nav nav-tabs mb-3" id="creditTabs" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="pending-tab" data-bs-toggle="tab" data-bs-target="#pending" type="button" role="tab">Очакващ решение</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="active-tab" data-bs-toggle="tab" data-bs-target="#active" type="button" role="tab">Активен</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="completed-tab" data-bs-toggle="tab" data-bs-target="#completed" type="button" role="tab">Приключен</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="rejected-tab" data-bs-toggle="tab" data-bs-target="#rejected" type="button" role="tab">Отхвърлен</button>
        </li>
    </ul>

    <div class="tab-content" id="creditTabsContent">
        <div class="tab-pane fade show active" id="pending" role="tabpanel" aria-labelledby="pending-tab">
            <ul class="list-group">
                @foreach (var c in Model.PendingCredits)
                {
                    <li class="list-group-item">
                        @c.CreditAmount лв.
                        <span class="badge bg-secondary ms-2">@c.StatusNavigation.Description</span>
                    </li>
                }
            </ul>
        </div>

        <div class="tab-pane fade" id="active" role="tabpanel" aria-labelledby="active-tab">
            <ul class="list-group">
                @foreach (var c in Model.ActiveCredits)
                {
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <div>
                            @c.CreditAmount лв. (@c.CreditBeginDate?.ToString("dd.MM.yyyy"))
                            <span class="badge bg-success ms-2">@c.StatusNavigation.Description</span>
                        </div>
                        <a asp-page="/RepaymentPlans/Index" asp-route-creditId="@c.ID"
                           class="btn btn-sm btn-outline-secondary">План</a>
                    </li>
                }
            </ul>
        </div>

        <div class="tab-pane fade" id="completed" role="tabpanel" aria-labelledby="completed-tab">
            <ul class="list-group">
                @foreach (var c in Model.CompletedCredits)
                {
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        @c.CreditAmount лв.
                        <span class="badge bg-dark ms-2">@c.StatusNavigation.Description</span>
                    </li>
                }
            </ul>
        </div>

        <div class="tab-pane fade" id="rejected" role="tabpanel" aria-labelledby="rejected-tab">
            <ul class="list-group">
                @foreach (var c in Model.RejectedCredits)
                {
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        @c.CreditAmount лв.
                        <span class="badge bg-dark ms-2">@c.StatusNavigation.Description</span>
                    </li>
                }
            </ul>
        </div>
    </div>

</div>